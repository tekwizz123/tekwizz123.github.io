---
layout: post
title: Nebula Exploit Exercise Level 00 Walkthrough
date: '2015-06-12T07:11:00.000-07:00'
author: thetekwizz
tags: 
modified_time: '2015-06-12T07:11:36.932-07:00'
blogger_id: tag:blogger.com,1999:blog-1094392735627525300.post-1126726769795296759
blogger_orig_url: https://tekwizz123.blogspot.com/2015/06/nebula-exploit-exercise-level-00.html
---

<h4 style="text-align: left;"><u>Intro</u></h4>So this is more of a reminder post to myself to track my progress through this thing, but I thought I might as well do a post seeing as there are already about 6 other solutions out there and the authors don't seem to mind walkthroughs too much.<br /><br />That being said, this is level 00. If your getting stuck on this, you should seriously try harder before you look at the solution. If you want to check your work however and think you have the solution, feel free to read on :)<br /><br /><h4 style="text-align: left;"><u>The Problem</u></h4><div style="text-align: left;">For Nebula's level 00 exercise, we are tasked with finding a setuid program that will run as the flag00 user. We are also given the hint that reading the manual page for the find command may help us find where this file is located.</div><div style="text-align: left;"><br /></div><div style="text-align: left;">So my first approach to this was to look up the manual page for the find command. However the manual page for the find command contains many different options and switches. Lets try grep out anything mentioning setuid or something along those lines shall we?</div><div style="text-align: left;"><br /></div><div style="text-align: left;"></div><h4 style="text-align: left;"><u>Solving the Problem</u></h4><div style="text-align: left;">First we log in with the username level00 and the password level00. Following this we issue the following command:</div><blockquote class="tr_bq"><div style="text-align: left;"><i><span style="font-size: small;">man find | grep -i suid</span></i></div></blockquote><blockquote><i><span style="font-size: small;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \( -perm -4000 -fprintf /root/suid.txt %#m %u %p\n \) , \<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; into /root/suid.txt and large files into /root/big.txt.&nbsp;</span></i></blockquote>We see that we can could run <i>find / -perm -4000 </i>to find all of the files with the setuid bit set from the root directory downwards. But why is this the case? If we look up setuid within Wikipedia we get the following information:<br /><blockquote class="tr_bq"><i><span style="font-size: small;">The <code>setuid</code> and <code>setgid</code> bits are normally set with the command <code><a href="https://en.wikipedia.org/wiki/Chmod" title="Chmod">chmod</a></code> by setting the high-order octal digit to 4 for <code>setuid</code> or 2 for <code>setgid</code>. "<code>chmod 6711 <em>file</em></code>" will set both the <code>setuid</code> and <code>setgid</code> bits (2+4=6) (Wikipedia, 2015, June 12 2015, <a href="https://en.wikipedia.org/wiki/Setuid">https://en.wikipedia.org/wiki/Setuid</a>)</span></i> </blockquote>Thus from this we can see that within the UNIX privilege management system, the first number (the 6 in <i>chmod 6711</i>) denotes if the file has setuid or setgid permissions or not. Thus by searching for files via <i>find / -perm -4000 </i>we are effectively searching for all of the files which have the setuid bit set. However this could return quite a few files, so lets pipe the output to a file and then cat the result.<br /><blockquote class="tr_bq"><i><span style="font-size: small;">level00@nebula:~$ find / -perm -4000 &gt; /tmp/results.txt </span></i><br /><i><span style="font-size: x-small;"><span style="font-size: small;">level00@nebula:~$ cat /tmp/results.txt <br />/bin/.../flag00<br />/bin/fusermount<br />/bin/mount<br />/bin/ping<br />/bin/ping6<br />/bin/su<br />/bin/umount<br />/sbin/mount.ecryptfs_private<br />/usr/bin/at<br />/usr/bin/chfn<br />/usr/bin/chsh<br />/usr/bin/gpasswd</span></span></i></blockquote>Ah, there we go :) We see that there is a file <i>/bin/.../flag00 </i>which seems to hold the suid flag that we need to complete this level. Lets check:<br /><blockquote class="tr_bq"><i><span style="font-size: small;">level00@nebula:~$ ls -alh /bin/.../flag00 <br />-rwsr-x--- 1 flag00 level00 7.2K 2011-11-20 21:22 /bin/.../flag00</span></i></blockquote>That looks like the one :) And if we execute it and then run <i>getflag</i>, we will see we have completed the challenge:<br /><blockquote class="tr_bq"><i><span style="font-size: small;">level00@nebula:~$ /bin/.../flag00 <br />Congrats, now run getflag to get your flag!<br />flag00@nebula:~$ getflag<br />You have successfully executed getflag on a target account</span></i></blockquote>